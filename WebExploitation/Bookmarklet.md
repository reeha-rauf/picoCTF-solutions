# Bookmarklet
Author: Jeffery John


## 📂 Category
- Web Exploitation  
- Difficulty: Easy  

---

## 🧩 Challenge Description

Why search for the flag when I can make a bookmarklet to print it for me?

---

## 🔍 Initial Observations

- The challenge page hinted that the flag could be revealed using a bookmarklet.
- A block of JavaScript was already provided, containing an `encryptedFlag` string and a `key`.
- The logic appeared to loop through the encrypted string, decode it using the key, and display the result via an `alert()`.

---

## 🧪 Exploitation Steps

1. Copied the entire provided code starting with `javascript:(function(){...})();`
2. Pressed `Ctrl + Shift + O` in Chrome to open the Bookmarks Manager.
3. Clicked the three dots (⋮) in the top right corner → "Add new bookmark".
4. In the bookmark's URL field, pasted the full JavaScript code (bookmarklet).
5. Returned to the challenge page and clicked the new bookmark.
6. A browser alert popped up displaying the decrypted flag.

---

## 🏁 Flag

picoCTF{p@g3_turn3r_0148cb05}

---

## 🧠 What I Learned

- A **bookmarklet** is a browser bookmark whose URL field contains JavaScript (`javascript:...`). When clicked, it runs that code on the current webpage.
- Bookmarklets can be used to:
    - Modify the page’s content (DOM)
    - Extract hidden data
    - Auto-fill forms
    - Run automation tasks inside your browser
- JavaScript run via bookmarklets **only affects the client side** — it cannot:
    - Change server-side data
    - Access the server's filesystem or database
    - Bypass real authentication (unless the site is poorly built)
- Bookmarklets (or any JS you run in the browser) can’t break out of the browser sandbox, but they can:
    - Steal cookies/tokens from that site
    - Capture your inputs
    - Modify what you see (e.g., for phishing)
- Self-XSS is when an attacker tricks a user into running JavaScript in their own browser, often using a fake console prompt or bookmarklet — this can lead to account compromise.
- While bookmarklets themselves aren’t a security risk, they demonstrate how powerful client-side JavaScript can be — and why it must be secured properly.

### **Code Explanation**

```javascript
    javascript:(function() {
    var encryptedFlag = "àÒÆÞ¦È¬ëÙ£ÖÓÚåÛÑ¢ÕÓ¡ÒÅ¤í";
    var key = "picoctf";
    var decryptedFlag = "";

    for (var i = 0; i < encryptedFlag.length; i++) {
        decryptedFlag += String.fromCharCode(
            (encryptedFlag.charCodeAt(i) - key.charCodeAt(i % key.length) + 256) % 256
        );
    }
    alert(decryptedFlag);
    })();
```

| Line                                        | Explanation                                                                                                                                                                                                                        |
| ------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `javascript:(function() { ... })();`        | The entire script is wrapped in a self-invoking function and prefixed with `javascript:` to make it a **bookmarklet**.                                                                                                             |
| `var encryptedFlag = "..."`                 | This is the **encrypted flag**, stored as a string of odd characters.                                                                                                                                                              |
| `var key = "picoctf";`                      | The key used to decrypt the flag. It loops repeatedly through the flag.                                                                                                                                                            |
| `decryptedFlag += String.fromCharCode(...)` | Decryption logic: for each character in the encrypted flag, subtract the corresponding key character’s ASCII code (looped using `i % key.length`), adjust for byte wraparound using `+256 % 256`, and convert back to a character. |
| `alert(decryptedFlag);`                     | Displays the **final decrypted flag** in a browser popup.                                                                                                                                                                          |

---
## 📚 References and Resources

- chatGPT

---
### Last updated: 5/19/2025




